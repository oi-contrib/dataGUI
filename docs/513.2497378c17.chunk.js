"use strict";(self.webpackChunkdatagui=self.webpackChunkdatagui||[]).push([[513],{513:(e,t,r)=>{r.r(t),r.d(t,{default:()=>p});var n=r(540),o=r(151);const i=e=>{const t=document.getElementsByTagName("head")[0];t.style.color=e;const r=((e,t)=>{const r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle;return"string"==typeof t?r.getPropertyValue(t):r})(t,"color").replace(/rgba?\(/,"").replace(")","").split(",");for(let e=0;e<r.length;e++)r[e]=+r[e];return r.push(1),[r[0]/255,r[1]/255,r[2]/255,r[3]]},a=JSON.parse('[{"value":1048,"name":"Search Engine"},{"value":735,"name":"Direct"},{"value":580,"name":"Email"},{"value":484,"name":"Union Ads"},{"value":300,"name":"Video Ads"}]');let l=(0,o.getLoopColors)(a.length);class s extends n.Component{constructor(e){super(e),this.refContent=n.createRef()}render(){return n.createElement("div",{style:{border:"1px solid gray",width:"700px",height:"500px",position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",textAlign:"center"}},n.createElement("div",{style:{fontSize:"20px",lineHeight:"50px",fontWeight:600}},"Referer of a Website"),n.createElement("div",{style:{fontSize:"12px",fontWeight:200}},"Fake Data"),n.createElement("ul",{style:{position:"absolute",textAlign:"left",left:"10px",top:"50px",fontSize:"12px",fontWeight:200}},a.map(((e,t)=>n.createElement("li",{style:{lineHeight:"16px",marginTop:"7px"},key:t},n.createElement("span",{style:{display:"inline-block",width:"25px",height:"16px",backgroundColor:l[t],verticalAlign:"top",marginRight:"5px",borderRadius:"3px"}}),e.name)))),n.createElement("div",{ref:this.refContent,style:{height:"435px"}}))}componentDidMount(){let e=[];for(let t=0;t<l.length;t++)e.push(i(l[t]));let t=(0,o.getLoopColors)(a.length,.9),r=[];for(let e=0;e<l.length;e++)r.push(i(t[e]));let n=(0,o.getWebGLContext)(this.refContent.current,1,"aspectFill");n.enable(n.DEPTH_TEST);let s=new o.Shader(n).compile("attribute vec4 a_position;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main()\r\n{\r\n    vec4 temp = u_matrix * a_position;\r\n\r\n    // 把原生的WebGL使用的左手坐标系变成了右手坐标系\r\n    temp.z = -1.0 * temp.z;\r\n\r\n    // 表示眼睛距离vec4(0.0,0.0,1.0)的距离\r\n    float dist = 4.0;\r\n\r\n    // 使用投影直接计算\r\n    // 为保证纹理和相对位置正确\r\n    // x、y、z的改变满足线性变换\r\n    gl_Position = vec4((dist + 1.0) * temp.x, (dist + 1.0) * temp.y, dist * (dist + temp.z) + 1.0 - dist * dist, temp.w * 2.0 * (dist + temp.z));\r\n}","precision mediump float;\r\n\r\nuniform vec4 u_color;\r\n\r\nvoid main()\r\n{\r\n    gl_FragColor = u_color;\r\n}").use(),p=n.getUniformLocation(s.program,"u_matrix"),u=n.getAttribLocation(s.program,"a_position"),d=n.getUniformLocation(s.program,"u_color"),m=new o.Buffer(n).use(),c=(new o.Matrix4).scale(.7,.7,.7).rotate(-1,1,0,0);n.uniformMatrix4fv(p,!1,c.value());let g=0;for(let e=0;e<a.length;e++)g+=a[e].value;let f=-.5*Math.PI;for(let t=0;t<a.length;t++){let i=a[t].value/g*Math.PI*2,l=[],s=[],p=[],c=[],h=Math.ceil(i*this.refContent.current.clientHeight*.1),x=.8,y=1.7,v=.1,w=i/h;for(let e=0;e<=h;e++){let t=(0,o.rotate)(0,0,f+w*e,y,0),r=(0,o.rotate)(0,0,f+w*e,x,0);l.push(t[0],t[1],v,r[0],r[1],v),s.push(t[0],t[1],-v,r[0],r[1],-v),p.push(r[0],r[1],v,r[0],r[1],-v),c.push(t[0],t[1],v,t[0],t[1],-v)}n.uniform4f(d,...e[t]),m.write(new Float32Array(l)).divide(u,3,3,0),n.drawArrays(n.TRIANGLE_STRIP,0,l.length/3),m.write(new Float32Array(s)).divide(u,3,3,0),n.drawArrays(n.TRIANGLE_STRIP,0,s.length/3),n.uniform4f(d,...r[t]),m.write(new Float32Array(p)).divide(u,3,3,0),n.drawArrays(n.TRIANGLE_STRIP,0,p.length/3),m.write(new Float32Array(c)).divide(u,3,3,0),n.drawArrays(n.TRIANGLE_STRIP,0,c.length/3),f+=i}}}const p=s}}]);