"use strict";(self.webpackChunkdatagui=self.webpackChunkdatagui||[]).push([[554],{554:(t,n,o)=>{o.r(n),o.d(n,{default:()=>c});var e=o(540),r=o(151);const i=function(t,n,o=2*Math.PI){const e=Math.ceil(o/Math.asin(t/n)*2);return isNaN(e)||e<12?12:e};function s(t,n,o,e,i,s,p,h=0,a=2*Math.PI){let l,u;if(4==s){const t=i/1.414;l=n+t,u=e+t}else l=n+i,u=e;let m=[l,u];0!=h&&(m=(0,r.rotate)(n,e,h,l,u));const c=[],_=a/s;for(let i=0;i<s;i++)c.push(n,o,e),t&&c.push(0,p,0),c.push(m[0],o,m[1]),t&&c.push(0,p,0),m=(0,r.rotate)(n,e,_*(i+1),l,u),c.push(m[0],o,m[1]),t&&c.push(0,p,0);return c}function p(t,n,o,e,i,s,p,h=0,a=2*Math.PI){const l=[];let u;u=4==p?(0,r.rotate)(n,e,.25*Math.PI,n-i,e):[n+i,e],0!=h&&(u=(0,r.rotate)(n,e,h,...u));const m=a/p,c=a/(2*p);let _,f=[];for(let i=0;i<p;i++){if(_=(0,r.rotate)(n,e,m,...u),t){const t=(0,r.rotate)(n,e,c,...u);f=[t[0],0,t[1]]}l.push(u[0],o,u[1],...f),l.push(u[0],o+s,u[1],...f),l.push(_[0],o+s,_[1],...f),l.push(u[0],o,u[1],...f),l.push(_[0],o,_[1],...f),l.push(_[0],o+s,_[1],...f),u=_}return l}function h(t,n,o,e,i,s,p){const h=[n,o+i,e],a=2*Math.PI/s;let l;t&&h.push(0,i,0);const u=()=>{h.push(...h.slice(h.length-(t?12:6)))};for(let m=1;m<.5*s;m++){l=(0,r.rotate)(n,o,a*m,n,o+i),m>1&&u();const s=(0,r.rotate)(n,e,a*p,l[0],e);h.push(s[0],l[1],s[1]),t&&h.push(s[0]-n,l[1]-o,s[1]-e),m>1&&u();const c=(0,r.rotate)(n,e,a*(p+1),l[0],e);h.push(c[0],l[1],c[1]),t&&h.push(c[0]-n,c[1]-o,c[1]-e)}return u(),h.push(n,o-i,e),t&&h.push(0,-i,0),h}function a(t,n,o,e,r,i){return(s,p,h,a)=>{if(t==e&&o==i)return[s,p,h];let l,u,m,c=s-(a?0:t),_=p-(a?0:n),f=h-(a?0:o);const d=e-t,g=r-n,L=i-o,x=Math.sqrt(d*d+L*L);u=d/x,l=L/x;const A=L*l+d*u,I=Math.sqrt(g*g+A*A);return u=g/I,l=A/I,m=[_,c],_=m[0]*u-m[1]*l,c=m[0]*l+m[1]*u,u=d/x,l=L/x,m=[c,f],c=m[0]*u-m[1]*l,f=m[0]*l+m[1]*u,[c+(a?0:t),_+(a?0:n),f+(a?0:o)]}}function l(t,n){if(t){const t=[];for(let o=0;o<n.length;o+=9){const e=[n[o+3]-n[o],n[o+4]-n[o+1],n[o+5]-n[o+2]],r=[n[o+6]-n[o],n[o+7]-n[o+1],n[o+8]-n[o+2]],i=[e[1]*r[2]-r[1]*e[2],e[2]*r[0]-e[0]*r[2],e[0]*r[1]-e[1]*r[2]];t.push(n[o],n[o+1],n[o+2],...i,n[o+3],n[o+4],n[o+5],...i,n[o+6],n[o+7],n[o+8],...i)}return t}return n}const u=class{constructor(t={}){this.__option=function(t,n){for(const o in t)n[o]=t[o];return n}(t,{precision:.1,normal:!1})}splitNum(t,n){return i(this.__option.precision,t,n)}rotateLine(t,n,o,e,r,i){const s=a(t,n,o,e,r,i);return(t,n,o)=>s(t,n,o,this.__option.normal)}prismHorizontal(t,n,o,e,r,i,p,h){return s(this.__option.normal,t,n,o,e,r,i,p,h)}prismVertical(t,n,o,e,r,i,s,h){return p(this.__option.normal,t,n,o,e,r,i,s,h)}sphereFragment(t,n,o,e,r,i){return h(this.__option.normal,t,n,o,e,r,i)}pie(t,n,o,e,h,a,u){const m=i(this.__option.precision,e,u),c=(0,r.rotate)(t,o,a,t+e,o),_=(0,r.rotate)(t,o,a+u,t+e,o);return[{name:"bottom",points:s(this.__option.normal,t,n,o,e,m,h>0?-1:1,a,u),length:3*m,method:"TRIANGLES"},{name:"top",points:s(this.__option.normal,t,n+h,o,e,m,h>0?1:-1,a,u),length:3*m,method:"TRIANGLES"},{name:"side",points:p(this.__option.normal,t,n,o,e,h,m,a,u),length:6*m,method:"TRIANGLES"},{name:"begin",points:l(this.__option.normal,[t,n,o,t,n+h,o,c[0],n,c[1],c[0],n+h,c[1],c[0],n,c[1],t,n+h,o]),length:6,method:"TRIANGLES"},{name:"end",points:l(this.__option.normal,[t,n,o,_[0],n,_[1],t,n+h,o,_[0],n+h,_[1],t,n+h,o,_[0],n,_[1]]),length:6,method:"TRIANGLES"}]}cylinder(t,n,o,e,r,s,p){const h=i(this.__option.precision,e);return 5==arguments.length?this.prism(t,n,o,e,r,h):this.prism(t,n,o,e,r,s,p,h)}prism(t,n,o,e,r,i,h,l){let u,m=null;6==arguments.length?(u=r,l=i):(u=(n>i?-1:1)*Math.sqrt((r-t)*(r-t)+(i-n)*(i-n)+(h-o)*(h-o)),m=a(t,n,o,r,i,h));const c=[{name:"bottom",points:[],length:0,method:"TRIANGLES"},{name:"top",points:[],length:0,method:"TRIANGLES"},{name:"side",points:[],length:0,method:"TRIANGLES"}];c[0].points.push(...s(this.__option.normal,t,n,o,e,l,u>0?-1:1)),c[1].points.push(...s(this.__option.normal,t,n+u,o,e,l,u>0?1:-1)),c[2].points.push(...p(this.__option.normal,t,n,o,e,u,l));for(let t=0;t<c.length;t++){if(m){const n=[];let o=!1;for(let e=0;e<c[t].points.length;e+=3)n.push(...m(c[t].points[e],c[t].points[e+1],c[t].points[e+2],this.__option.normal&&o)),o=!o;c[t].points=n}c[t].length=c[t].points.length/(this.__option.normal?6:3)}return c}sphere(t,n,o,e){const r=i(this.__option.precision,e),s=[{name:"surface",points:[],length:0,method:"TRIANGLES"}];for(let i=0;i<r;i++)s[0].points.push(...h(this.__option.normal,t,n,o,e,r,i));return s[0].length=s[0].points.length/(this.__option.normal?6:3),s}};class m extends e.Component{isClose=!1;constructor(t){super(t),this.refContent=e.createRef()}render(){return e.createElement("div",{ref:this.refContent,style:{border:"1px solid gray",width:"500px",height:"500px",position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",textAlign:"center"}})}componentDidMount(){let t=this,n=new u,o=(0,r.getWebGLContext)(this.refContent.current),e=new r.Shader(o).compile("attribute vec4 a_position;\r\nuniform mat4 u_matrix;\r\n\r\nvoid main()\r\n{\r\n    vec4 temp = u_matrix * a_position;\r\n\r\n    // 把原生的WebGL使用的左手坐标系变成了右手坐标系\r\n    temp.z = -1.0 * temp.z;\r\n\r\n    // 表示眼睛距离vec4(0.0,0.0,1.0)的距离\r\n    float dist = 4.0;\r\n\r\n    // 使用投影直接计算\r\n    // 为保证纹理和相对位置正确\r\n    // x、y、z的改变满足线性变换\r\n    gl_Position = vec4((dist + 1.0) * temp.x, (dist + 1.0) * temp.y, dist * (dist + temp.z) + 1.0 - dist * dist, temp.w * 2.0 * (dist + temp.z));\r\n}","precision mediump float;\r\n\r\nuniform vec4 u_color;\r\n\r\nvoid main()\r\n{\r\n    gl_FragColor = u_color;\r\n}").use(),i=new r.Buffer(o).use();o.enable(o.DEPTH_TEST);let s=n.sphere(-.7,0,0,.36),p=n.sphere(.7,0,0,.36),h=n.sphere(0,.7,0,.5),a=n.cylinder(-.7,0,0,.16,0,.7,0),l=n.cylinder(.7,0,0,.16,0,.7,0),m=new r.Matrix4,c=o.getUniformLocation(e.program,"u_matrix"),_=o.getAttribLocation(e.program,"a_position"),f=o.getUniformLocation(e.program,"u_color"),d=function(t){for(let n=0;n<t.length;n++)i.write(new Float32Array(t[n].points)).divide(_,3,3,0),o.drawArrays(o[t[n].method],0,t[n].length)};!function n(){o.uniformMatrix4fv(c,!1,m.rotate(.05,-1,.2,0,1,.2,0).value()),o.uniform4f(f,1,.2,.2,1),d(h),o.uniform4f(f,.6,.6,.6,1),d(s),d(p),o.uniform4f(f,.2,.3,.1,.4),d(a),d(l),t.isClose||requestAnimationFrame(n)}()}componentWillUnmount(){this.isClose=!0}}const c=m}}]);